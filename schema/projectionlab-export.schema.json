{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://github.com/nguyening/projectionlab-mcp/schema/projectionlab-export.schema.json",
  "title": "ProjectionLab Export",
  "description": "Schema for ProjectionLab financial planning data export",
  "type": "object",
  "required": ["meta", "today", "plans", "settings"],
  "properties": {
    "meta": { "$ref": "#/$defs/Meta" },
    "today": { "$ref": "#/$defs/Today" },
    "plans": { "type": "array", "items": { "$ref": "#/$defs/Plan" } },
    "progress": { "$ref": "#/$defs/Progress" },
    "settings": { "$ref": "#/$defs/Settings" }
  },
  "$defs": {
    "Meta": {
      "type": "object",
      "description": "Export metadata",
      "required": ["version", "lastUpdated"],
      "properties": {
        "version": { "type": "string", "description": "ProjectionLab version" },
        "lastUpdated": { "type": "integer", "description": "Unix timestamp in milliseconds" }
      }
    },
    "DateReference": {
      "type": "object",
      "description": "Flexible date reference - can be keyword, milestone, date, or year",
      "required": ["type", "value"],
      "properties": {
        "type": { "type": "string", "enum": ["keyword", "milestone", "date", "year"] },
        "value": { "type": "string", "description": "Keyword (now, beforeCurrentYear, endOfPlan, never), milestone ID, or ISO date" },
        "modifier": {
          "oneOf": [
            { "type": "string", "enum": ["include", "exclude"] },
            { "type": "integer", "description": "Offset in years" }
          ]
        },
        "logic": { "type": "string", "enum": ["and", "or"] }
      }
    },
    "YearlyChange": {
      "type": "object",
      "description": "How a value changes over time",
      "properties": {
        "type": { "type": "string", "enum": ["none", "match-inflation", "inflation+", "increase", "decrease", "depreciate", "appreciate", "custom"] },
        "amount": { "type": "number" },
        "amountType": { "type": "string", "enum": ["today$", "%"] },
        "limitEnabled": { "type": "boolean" },
        "limit": { "type": "number" },
        "limitType": { "type": "string", "enum": ["today$", "%"] },
        "custom": { "$ref": "#/$defs/CustomCurve" }
      }
    },
    "CustomCurve": {
      "type": "object",
      "properties": {
        "type": { "type": "string", "enum": ["%", "today$"] },
        "data": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": { "x": { "type": "number" }, "y": { "type": "number" } }
          }
        }
      }
    },
    "Owner": { "type": "string", "enum": ["me", "spouse", "joint"] },
    "Today": {
      "type": "object",
      "description": "Current financial snapshot",
      "properties": {
        "schema": { "type": "number" },
        "tab": { "type": "integer" },
        "lastUpdated": { "type": "integer" },
        "location": {
          "type": "object",
          "properties": { "country": { "type": "string" }, "state": { "type": "string" } }
        },
        "partnerStatus": { "type": "string", "enum": ["single", "couple"] },
        "age": { "type": "integer" },
        "birthYear": { "type": "integer" },
        "birthMonth": { "type": "integer" },
        "yourName": { "type": "string" },
        "yourColor": { "type": "string" },
        "yourIcon": { "type": "string" },
        "spouseAge": { "type": "integer" },
        "spouseAgeGap": { "type": "integer" },
        "spouseBirthYear": { "type": "integer" },
        "spouseBirthMonth": { "type": "integer" },
        "spouseName": { "type": "string" },
        "spouseColor": { "type": "string" },
        "spouseIcon": { "type": "string" },
        "savingsAccounts": { "type": "array", "items": { "$ref": "#/$defs/SavingsAccount" } },
        "investmentAccounts": { "type": "array", "items": { "$ref": "#/$defs/InvestmentAccount" } },
        "debts": { "type": "array", "items": { "$ref": "#/$defs/Debt" } },
        "assets": { "type": "array", "items": { "$ref": "#/$defs/Asset" } }
      }
    },
    "SavingsAccount": {
      "type": "object",
      "description": "Savings or checking account",
      "required": ["id", "type", "balance"],
      "properties": {
        "id": { "type": "string" },
        "type": { "type": "string", "const": "savings" },
        "name": { "type": "string" },
        "title": { "type": "string" },
        "balance": { "type": "number" },
        "owner": { "$ref": "#/$defs/Owner" },
        "color": { "type": "string" },
        "icon": { "type": "string" },
        "liquid": { "type": "boolean" },
        "withdraw": { "type": "boolean" },
        "withdrawAge": { "$ref": "#/$defs/DateReference" },
        "repurpose": { "type": "boolean" },
        "isPassiveIncome": { "type": "boolean" },
        "investmentGrowthType": { "type": "string", "enum": ["fixed", "plan", "none", "custom"] },
        "investmentGrowthRate": { "type": "number" },
        "dividendType": { "type": "string", "enum": ["none", "plan", "fixed", "custom"] },
        "dividendRate": { "type": "number" }
      }
    },
    "InvestmentAccount": {
      "type": "object",
      "description": "Investment account (401k, IRA, HSA, taxable, 529)",
      "required": ["id", "type", "balance"],
      "properties": {
        "id": { "type": "string" },
        "type": { "type": "string", "enum": ["401k", "roth-ira", "traditional-ira", "hsa", "taxable", "529"] },
        "name": { "type": "string" },
        "title": { "type": "string" },
        "subtitle": { "type": "string" },
        "balance": { "type": "number" },
        "costBasis": { "type": "number" },
        "owner": { "$ref": "#/$defs/Owner" },
        "color": { "type": "string" },
        "icon": { "type": "string" },
        "country": { "type": "string" },
        "liquid": { "type": "boolean" },
        "withdraw": { "type": "boolean" },
        "withdrawAge": { "$ref": "#/$defs/DateReference" },
        "withdrawContribsFree": { "type": "boolean" },
        "isPassiveIncome": { "type": "boolean" },
        "hasEWPenalty": { "type": "boolean", "description": "Has early withdrawal penalty" },
        "EWAge": { "type": "integer", "description": "Early withdrawal penalty age" },
        "EWPenaltyRate": { "type": "number", "description": "Early withdrawal penalty rate %" },
        "rmdType": { "type": "string", "enum": ["us", "none"] },
        "investmentGrowthType": { "type": "string", "enum": ["fixed", "plan", "none", "custom"] },
        "investmentGrowthRate": { "type": "number" },
        "dividendType": { "type": "string", "enum": ["none", "plan", "fixed", "custom"] },
        "dividendRate": { "type": "number" },
        "dividendReinvestment": { "type": "boolean" },
        "dividendsArePassiveIncome": { "type": "boolean" },
        "dividendTaxType": { "type": "string", "enum": ["plan", "income", "capGains"] },
        "yearlyFee": { "type": "number" },
        "yearlyFeeType": { "type": "string", "enum": ["%", "today$"] },
        "displayAge": { "$ref": "#/$defs/DateReference" },
        "excludeFromFinances": { "type": "boolean" }
      }
    },
    "Debt": {
      "type": "object",
      "description": "Debt (student loans, mortgage, etc.)",
      "required": ["id", "type", "amount"],
      "properties": {
        "id": { "type": "string" },
        "type": { "type": "string", "const": "debt" },
        "subtype": { "type": "string", "enum": ["student-loans", "mortgage", "auto", "credit-card", "personal", "other"] },
        "name": { "type": "string" },
        "title": { "type": "string" },
        "amount": { "type": "number" },
        "amountType": { "type": "string", "enum": ["today$", "future$"] },
        "owner": { "$ref": "#/$defs/Owner" },
        "color": { "type": "string" },
        "icon": { "type": "string" },
        "interestRate": { "type": "number" },
        "interestType": { "type": "string", "enum": ["simple", "compound"] },
        "compounding": { "type": "string", "enum": ["daily", "monthly", "yearly"] },
        "monthlyPayment": { "type": "number" },
        "monthlyPaymentType": { "type": "string", "enum": ["today$", "future$"] },
        "frequency": { "type": "string", "enum": ["monthly", "bi-weekly", "weekly", "yearly"] },
        "frequencyChoices": { "type": "boolean" },
        "start": { "$ref": "#/$defs/DateReference" },
        "end": { "$ref": "#/$defs/DateReference" },
        "effectiveDate": { "$ref": "#/$defs/DateReference" },
        "hasForgiveness": { "type": "boolean" },
        "forgiveAt": { "$ref": "#/$defs/DateReference" },
        "yearlyChange": { "$ref": "#/$defs/YearlyChange" },
        "planPath": { "type": "string" }
      }
    },
    "Asset": {
      "type": "object",
      "description": "Physical asset (car, real estate)",
      "required": ["id", "type"],
      "properties": {
        "id": { "type": "string" },
        "type": { "type": "string", "enum": ["car", "real-estate", "other"] },
        "name": { "type": "string" },
        "title": { "type": "string" },
        "owner": { "$ref": "#/$defs/Owner" },
        "color": { "type": "string" },
        "icon": { "type": "string" },
        "initialValue": { "type": "number" },
        "initialValueType": { "type": "string", "enum": ["today$", "future$"] },
        "amount": { "type": "number", "description": "Current value" },
        "amountType": { "type": "string", "enum": ["today$", "future$"] },
        "balance": { "type": "number", "description": "Loan balance" },
        "balanceType": { "type": "string", "enum": ["today$", "future$"] },
        "paymentMethod": { "type": "string", "enum": ["pay-in-full", "financed"] },
        "downPayment": { "type": "number" },
        "downPaymentType": { "type": "string", "enum": ["today$", "future$"] },
        "monthlyPayment": { "type": "number" },
        "monthlyPaymentType": { "type": "string", "enum": ["today$", "future$"] },
        "interestRate": { "type": "number" },
        "interestType": { "type": "string", "enum": ["simple", "compound"] },
        "compounding": { "type": "string", "enum": ["daily", "monthly", "yearly"] },
        "taxRate": { "type": "number" },
        "taxRateType": { "type": "string", "enum": ["%", "today$"] },
        "maintenanceRate": { "type": "number" },
        "maintenanceRateType": { "type": "string", "enum": ["%", "today$"] },
        "insuranceRate": { "type": "number" },
        "insuranceRateType": { "type": "string", "enum": ["%", "today$"] },
        "brokersFee": { "type": "number" },
        "yearlyChange": { "$ref": "#/$defs/YearlyChange" },
        "start": { "$ref": "#/$defs/DateReference" },
        "end": { "$ref": "#/$defs/DateReference" },
        "repeat": { "type": "boolean" },
        "excludeLoanFromLNW": { "type": "boolean" },
        "sellIfNeeded": { "type": "boolean" },
        "modifyAccount": { "type": "boolean" },
        "planPath": { "type": "string" },
        "improvementRate": { "type": "number" },
        "improvementRateType": { "type": "string", "enum": ["%", "today$"] },
        "managementRate": { "type": "number" },
        "managementRateType": { "type": "string", "enum": ["%", "today$"] },
        "cancelRent": { "type": "boolean" },
        "generateIncome": { "type": "boolean" },
        "isPassiveIncome": { "type": "boolean" },
        "incomeRate": { "type": "number" },
        "incomeRateType": { "type": "string", "enum": ["%", "today$"] },
        "monthlyHOA": { "type": "number" },
        "estimateRentalDeductions": { "type": "boolean" },
        "estimateQBI": { "type": "boolean" },
        "percentRented": { "type": "number" },
        "initialBuildingValue": { "type": "number" },
        "initialBuildingValueType": { "type": "string", "enum": ["today$", "future$"] },
        "selfEmployment": { "type": "boolean" },
        "classification": { "type": "string", "enum": ["residential", "commercial"] }
      }
    },
    "Plan": {
      "type": "object",
      "description": "Financial projection plan",
      "required": ["id", "name"],
      "properties": {
        "id": { "type": "string" },
        "name": { "type": "string" },
        "icon": { "type": "string" },
        "schema": { "type": "number" },
        "simKey": { "type": "integer" },
        "active": { "type": "boolean" },
        "initialized": { "type": "boolean" },
        "hasNotes": { "type": "boolean" },
        "lastUpdated": { "type": "integer" },
        "variables": { "$ref": "#/$defs/PlanVariables" },
        "milestones": { "type": "array", "items": { "$ref": "#/$defs/Milestone" } },
        "computedMilestones": { "type": "array", "items": { "$ref": "#/$defs/Milestone" } },
        "accounts": { "type": "object", "properties": { "events": { "type": "array", "items": { "$ref": "#/$defs/PlanAccount" } } } },
        "income": { "type": "object", "properties": { "events": { "type": "array", "items": { "$ref": "#/$defs/IncomeEvent" } } } },
        "expenses": { "type": "object", "properties": { "events": { "type": "array", "items": { "$ref": "#/$defs/ExpenseEvent" } } } },
        "assets": { "type": "object", "properties": { "events": { "type": "array", "items": { "$ref": "#/$defs/AssetEvent" } } } },
        "priorities": { "type": "object", "properties": { "events": { "type": "array", "items": { "$ref": "#/$defs/PriorityEvent" } } } },
        "withdrawalStrategy": { "$ref": "#/$defs/WithdrawalStrategy" },
        "montecarlo": { "$ref": "#/$defs/MonteCarloSettings" },
        "meta": { "type": "object" },
        "startingConditionsType": { "type": "string" },
        "startingConditions": { "type": "object" }
      }
    },
    "PlanVariables": {
      "type": "object",
      "description": "Plan assumptions and tax settings",
      "properties": {
        "assumptionsMode": { "type": "string", "enum": ["fixed", "custom", "backtest"] },
        "startYear": { "type": "integer" },
        "loopYear": { "type": "integer" },
        "startDate": { "type": "string" },
        "projectFrom": { "type": "string" },
        "showFutureDollars": { "type": "boolean" },
        "investmentReturn": { "type": "number" },
        "investmentReturnModifier": { "type": "number" },
        "investmentReturnCustom": { "$ref": "#/$defs/CustomCurve" },
        "dividendRate": { "type": "number" },
        "dividendRateModifier": { "type": "number" },
        "dividendRateCustom": { "$ref": "#/$defs/CustomCurve" },
        "inflation": { "type": "number" },
        "inflationModifier": { "type": "number" },
        "inflationCustom": { "$ref": "#/$defs/CustomCurve" },
        "bondAllocationType": { "type": "string", "enum": ["fixed", "custom", "age-in-bonds"] },
        "bondAllocation": { "type": "array", "items": { "type": "object", "properties": { "x": { "type": "number" }, "y": { "type": "number" } } } },
        "bondDividendRate": { "type": "number" },
        "bondDividendRateModifier": { "type": "number" },
        "bondDividendRateCustom": { "$ref": "#/$defs/CustomCurve" },
        "bondInvestmentReturn": { "type": "number" },
        "bondInvestmentReturnModifier": { "type": "number" },
        "bondInvestmentReturnCustom": { "$ref": "#/$defs/CustomCurve" },
        "bondLocation": { "type": "object", "properties": { "type": { "type": "string" }, "accountOrder": { "type": "array", "items": { "type": "string" } } } },
        "cashFlowDefault": { "type": "string", "enum": ["save", "spend"] },
        "drawdownOrder": { "type": "array", "items": { "type": "string" }, "description": "Order of account types to withdraw from" },
        "filingStatus": { "type": "string", "enum": ["single", "joint", "married-separate", "head-of-household"] },
        "incomeTaxMode": { "type": "string", "enum": ["fixed", "brackets", "custom"] },
        "effectiveIncomeTaxRate": { "type": "number" },
        "incomeTaxNational": { "type": "object", "properties": { "name": { "type": "string" }, "icon": { "type": "string" }, "brackets": { "type": "array" }, "standardDeduction": { "type": "number" } } },
        "incomeTaxExtra": { "type": "array" },
        "incomeTaxModifier": { "type": "number" },
        "localIncomeTaxRate": { "type": "number" },
        "capGainsMode": { "type": "string", "enum": ["fixed", "brackets", "income"] },
        "capGainsTaxRate": { "type": "number" },
        "capGainsTaxablePercent": { "type": "number" },
        "capGainsTaxAsIncome": { "type": "boolean" },
        "capGains": { "type": "object", "properties": { "brackets": { "type": "array" }, "offset": { "type": "string" } } },
        "capGainsModifier": { "type": "number" },
        "dividendTaxMode": { "type": "string", "enum": ["fixed", "capGains", "income", "brackets"] },
        "dividendTaxRate": { "type": "number" },
        "dividendTax": { "type": "object" },
        "bondDividendTaxMode": { "type": "string", "enum": ["income", "capGains", "fixed"] },
        "bondDividendTaxRate": { "type": "number" },
        "bondDividendTax": { "type": "object" },
        "fttMode": { "type": "string", "enum": ["none", "fixed"] },
        "fttRate": { "type": "number" },
        "fttTaxableEvent": { "type": "string" },
        "wealthTaxMode": { "type": "string", "enum": ["none", "fixed", "brackets"] },
        "wealthTaxRate": { "type": "number" },
        "wealthTaxMetric": { "type": "string" },
        "wealthTax": { "type": "object" },
        "medicare": { "type": "boolean" },
        "irmaa": { "type": "boolean" },
        "tcjaReversion": { "type": "boolean" },
        "bbbSaltReversion": { "type": "boolean" },
        "bbbSeniorReversion": { "type": "boolean" },
        "estimateTaxes": { "type": "boolean" },
        "withholding": { "type": "object", "properties": { "taxDeferred": { "type": "number" }, "taxable": { "type": "number" }, "conversions": { "type": "number" } } },
        "showRothConversionIcons": { "type": "boolean" },
        "flexSpending": { "type": "object", "properties": { "enabled": { "type": "boolean" }, "points": { "type": "array" }, "scope": { "type": "string" }, "interpolation": { "type": "string" } } }
      }
    },
    "Milestone": {
      "type": "object",
      "description": "Life milestone (retirement, FIRE, etc.)",
      "required": ["id", "name"],
      "properties": {
        "id": { "type": "string" },
        "name": { "type": "string" },
        "icon": { "type": "string" },
        "color": { "type": "string" },
        "removable": { "type": "boolean" },
        "version": { "type": "string" },
        "showChartIcon": { "type": "boolean" },
        "goalId": { "type": "string" },
        "criteria": { "type": "array", "items": { "$ref": "#/$defs/MilestoneCriterion" } }
      }
    },
    "MilestoneCriterion": {
      "type": "object",
      "description": "Condition for milestone completion",
      "properties": {
        "type": { "type": "string", "enum": ["year", "date", "milestone", "netWorth", "account", "totalDebt"] },
        "value": { "oneOf": [{ "type": "string" }, { "type": "number" }] },
        "valueType": { "type": "string", "enum": ["$", "today$", "expenses", "%"] },
        "operator": { "type": "string", "enum": [">=", "<=", "==", ">", "<"] },
        "modifier": { "type": "string", "enum": ["include", "exclude"] },
        "logic": { "type": "string", "enum": ["and", "or"] },
        "range": { "type": "number" },
        "fixedRange": { "type": "boolean" },
        "measurement": { "type": "string" },
        "removable": { "type": "boolean" },
        "refId": { "type": "string" }
      }
    },
    "PlanAccount": {
      "type": "object",
      "description": "Account reference in a plan with overrides",
      "properties": {
        "id": { "type": "string" },
        "accountId": { "type": "string", "description": "Reference to account in today" },
        "planPath": { "type": "string" },
        "persistent": { "type": "boolean" },
        "key": { "type": "number" }
      },
      "additionalProperties": true
    },
    "IncomeEvent": {
      "type": "object",
      "description": "Income source in a plan",
      "required": ["id", "type"],
      "properties": {
        "id": { "type": "string" },
        "type": { "type": "string", "enum": ["salary", "rsu", "social-security", "pension", "rental", "other"] },
        "name": { "type": "string" },
        "title": { "type": "string" },
        "icon": { "type": "string" },
        "owner": { "$ref": "#/$defs/Owner" },
        "amount": { "type": "number" },
        "amountType": { "type": "string", "enum": ["today$", "future$"] },
        "frequency": { "type": "string", "enum": ["yearly", "monthly", "bi-weekly", "weekly", "quarterly", "once"] },
        "frequencyChoices": { "type": "boolean" },
        "start": { "$ref": "#/$defs/DateReference" },
        "end": { "$ref": "#/$defs/DateReference" },
        "yearlyChange": { "$ref": "#/$defs/YearlyChange" },
        "taxWithholding": { "type": "boolean" },
        "taxExempt": { "type": "boolean" },
        "withhold": { "type": "number" },
        "selfEmployment": { "type": "boolean" },
        "wage": { "type": "boolean" },
        "goPartTime": { "type": "boolean" },
        "partTimeStart": { "$ref": "#/$defs/DateReference" },
        "partTimeEnd": { "$ref": "#/$defs/DateReference" },
        "partTimeRate": { "type": "number" },
        "hasPension": { "type": "boolean" },
        "pensionContribution": { "type": "number" },
        "pensionContributionType": { "type": "string" },
        "contribsReduceTaxableIncome": { "type": "boolean" },
        "pensionPayoutType": { "type": "string" },
        "pensionPayoutsStart": { "$ref": "#/$defs/DateReference" },
        "pensionPayoutsEnd": { "$ref": "#/$defs/DateReference" },
        "pensionPayoutRate": { "type": "number" },
        "pensionPayoutAmount": { "type": "number" },
        "pensionPayoutsAreTaxFree": { "type": "boolean" },
        "routeToAccounts": { "type": "boolean" },
        "repeat": { "type": "boolean" },
        "isDividendIncome": { "type": "boolean" },
        "isPassiveIncome": { "type": "boolean" },
        "preventOverflow": { "type": "boolean" },
        "planPath": { "type": "string" },
        "key": { "type": "number" }
      }
    },
    "ExpenseEvent": {
      "type": "object",
      "description": "Expense in a plan",
      "required": ["id", "type"],
      "properties": {
        "id": { "type": "string" },
        "type": { "type": "string", "enum": ["living-expenses", "debt", "charity", "education", "dependent-support", "healthcare", "other"] },
        "subtype": { "type": "string" },
        "name": { "type": "string" },
        "title": { "type": "string" },
        "icon": { "type": "string" },
        "color": { "type": "string" },
        "owner": { "$ref": "#/$defs/Owner" },
        "amount": { "type": "number" },
        "amountType": { "type": "string", "enum": ["today$", "future$"] },
        "frequency": { "type": "string", "enum": ["yearly", "monthly", "bi-weekly", "weekly", "quarterly", "once"] },
        "frequencyChoices": { "type": "boolean" },
        "start": { "$ref": "#/$defs/DateReference" },
        "end": { "$ref": "#/$defs/DateReference" },
        "yearlyChange": { "$ref": "#/$defs/YearlyChange" },
        "spendingType": { "type": "string", "enum": ["essential", "discretionary", "flex"] },
        "taxDeductible": { "oneOf": [{ "type": "boolean" }, { "type": "array", "items": { "type": "string" } }] },
        "itemized": { "type": "boolean" },
        "fundWithAccount": { "type": "boolean" },
        "fundWithAccounts": { "type": "array", "items": { "type": "string" } },
        "repeat": { "type": "boolean" },
        "repeatInterval": { "type": "number" },
        "repeatIntervalType": { "type": "string" },
        "repeatScaler": { "type": "number" },
        "repeatEnd": { "$ref": "#/$defs/DateReference" },
        "hidden": { "type": "boolean" },
        "debtId": { "type": "string" },
        "persistent": { "type": "boolean" },
        "planPath": { "type": "string" },
        "key": { "type": "number" },
        "monthlyPayment": { "type": "number" },
        "monthlyPaymentType": { "type": "string" },
        "interestRate": { "type": "number" },
        "interestType": { "type": "string" },
        "compounding": { "type": "string" },
        "effectiveDate": { "$ref": "#/$defs/DateReference" },
        "hasForgiveness": { "type": "boolean" },
        "forgiveAt": { "$ref": "#/$defs/DateReference" }
      }
    },
    "AssetEvent": {
      "type": "object",
      "description": "Asset in a plan context",
      "properties": {
        "id": { "type": "string" },
        "assetId": { "type": "string", "description": "Reference to asset in today" },
        "type": { "type": "string", "enum": ["car", "real-estate", "other"] },
        "name": { "type": "string" },
        "title": { "type": "string" },
        "icon": { "type": "string" },
        "color": { "type": "string" },
        "owner": { "$ref": "#/$defs/Owner" },
        "persistent": { "type": "boolean" },
        "planPath": { "type": "string" },
        "key": { "type": "number" }
      },
      "additionalProperties": true
    },
    "PriorityEvent": {
      "type": "object",
      "description": "Cash flow priority (contribution, debt payment, etc.)",
      "required": ["id", "type"],
      "properties": {
        "id": { "type": "string" },
        "type": { "type": "string", "enum": ["401k", "roth-ira", "traditional-ira", "hsa", "529", "taxable", "savings", "debt", "asset", "mega-backdoor", "espp"] },
        "subtype": { "type": "string" },
        "name": { "type": "string" },
        "title": { "type": "string" },
        "subtitle": { "type": "string" },
        "icon": { "type": "string" },
        "color": { "type": "string" },
        "owner": { "$ref": "#/$defs/Owner" },
        "accountId": { "type": "string", "description": "Target account for contributions" },
        "debtId": { "type": "string", "description": "Target debt for payments" },
        "assetId": { "type": "string", "description": "Target asset for payments" },
        "incomeStreamId": { "type": "string", "description": "Source income for deductions" },
        "deductFromIncomeId": { "type": "string" },
        "goalIntent": { "type": "string", "enum": ["invest", "maintain", "pay-extra", "save"] },
        "mode": { "type": "string", "enum": ["target", "contribution"] },
        "showChartIcon": { "type": "boolean" },
        "amount": { "type": "number" },
        "amountType": { "type": "string", "enum": ["today$", "future$"] },
        "contribution": { "type": "number" },
        "contributionType": { "type": "string", "enum": ["today$", "%"] },
        "contributionLimit": { "type": "number" },
        "contributionsAreFixed": { "type": "boolean" },
        "desiredContribution": { "type": "string", "enum": ["max", "%-remaining", "fixed"] },
        "employerMatch": { "type": "number" },
        "employerMatchType": { "type": "string", "enum": ["%-contrib-max-$", "%-salary-max-$", "today$", "%"] },
        "employerMatchLimit": { "type": "number" },
        "reduceEmployerMatch": { "type": "boolean" },
        "yearlyLimitType": { "type": "string", "enum": ["us", "custom", "none"] },
        "yearlyLimit": { "type": "number" },
        "yearlyLimit$Type": { "type": "string" },
        "frequency": { "type": "string", "enum": ["yearly", "monthly", "bi-weekly"] },
        "frequencyChoices": { "type": "boolean" },
        "start": { "$ref": "#/$defs/DateReference" },
        "end": { "$ref": "#/$defs/DateReference" },
        "monthlyPayment": { "type": "number" },
        "monthlyPaymentType": { "type": "string" },
        "extra": { "type": "number" },
        "extraType": { "type": "string" },
        "tapFund": { "type": "boolean" },
        "tapRate": { "type": "number" },
        "taxDeductible": { "type": "boolean" },
        "country": { "type": "string" },
        "persistent": { "type": "boolean" },
        "hidden": { "type": "boolean" },
        "planPath": { "type": "string" },
        "key": { "type": "number" },
        "interestRate": { "type": "number" },
        "interestType": { "type": "string" },
        "compounding": { "type": "string" },
        "effectiveDate": { "$ref": "#/$defs/DateReference" },
        "hasForgiveness": { "type": "boolean" },
        "forgiveAt": { "$ref": "#/$defs/DateReference" }
      },
      "additionalProperties": true
    },
    "WithdrawalStrategy": {
      "type": "object",
      "description": "Retirement withdrawal strategy",
      "properties": {
        "enabled": { "type": "boolean" },
        "strategy": { "type": "string", "enum": ["initial-%", "fixed-%", "fixed-amount", "1/N", "vpw", "kitces-ratchet", "clyatt-95%", "guyton-klinger"] },
        "start": { "$ref": "#/$defs/DateReference" },
        "income": { "type": "string" },
        "spendMode": { "type": "string", "enum": ["withdraw", "spend"] },
        "initial-%": { "type": "object", "properties": { "amount": { "type": "number" }, "min": { "type": "number" }, "minType": { "type": "string" }, "minEnabled": { "type": "boolean" }, "max": { "type": "number" }, "maxType": { "type": "string" }, "maxEnabled": { "type": "boolean" } } },
        "fixed-%": { "type": "object" },
        "fixed-amount": { "type": "object", "properties": { "amount": { "type": "number" }, "amountType": { "type": "string" }, "adjust": { "type": "boolean" } } },
        "1/N": { "type": "object" },
        "vpw": { "type": "object" },
        "kitces-ratchet": { "type": "object", "properties": { "amount": { "type": "number" }, "threshold": { "type": "number" }, "ratchet": { "type": "number" }, "cooldown": { "type": "number" } } },
        "clyatt-95%": { "type": "object" },
        "guyton-klinger": { "type": "object", "properties": { "amount": { "type": "number" }, "guardrail": { "type": "number" }, "adjustment": { "type": "number" } } }
      }
    },
    "MonteCarloSettings": {
      "type": "object",
      "description": "Monte Carlo simulation settings",
      "properties": {
        "trials": { "type": "integer" },
        "iterations": { "type": "integer" },
        "mode": { "type": "string", "enum": ["custom", "historical", "normal"] },
        "sampling": { "type": "string", "enum": ["backtest-random-restart", "backtest-sequential", "normal"] },
        "blockSize": { "type": "integer" },
        "metric": { "type": "string" },
        "metrics": { "type": "array", "items": { "type": "string" } },
        "statsMetric": { "type": "string" },
        "trialMetric": { "type": "string" },
        "splitPoint": { "type": "string" },
        "splitPointModifier": { "type": "string" },
        "investmentReturn": { "type": "string" },
        "investmentReturnMean": { "type": "number" },
        "investmentReturnStdDev": { "type": "number" },
        "dividendRate": { "type": "string" },
        "dividendRateMean": { "type": "number" },
        "dividendRateStdDev": { "type": "number" },
        "inflation": { "type": "string" },
        "inflationMean": { "type": "number" },
        "inflationStdDev": { "type": "number" },
        "bondReturn": { "type": "string" },
        "bondReturnMean": { "type": "number" },
        "bondReturnStdDev": { "type": "number" },
        "cryptoReturn": { "type": "string" },
        "cryptoReturnMean": { "type": "number" },
        "cryptoReturnStdDev": { "type": "number" }
      }
    },
    "Progress": {
      "type": "object",
      "description": "Historical net worth tracking",
      "properties": {
        "lastUpdated": { "type": "integer" },
        "data": { "type": "array", "items": { "$ref": "#/$defs/ProgressSnapshot" } }
      }
    },
    "ProgressSnapshot": {
      "type": "object",
      "description": "Point-in-time financial snapshot",
      "properties": {
        "date": { "type": "integer", "description": "Unix timestamp in milliseconds" },
        "netWorth": { "type": "number" },
        "savings": { "type": "number" },
        "taxable": { "type": "number" },
        "taxDeferred": { "type": "number" },
        "taxFree": { "type": "number" },
        "crypto": { "type": "number" },
        "assets": { "type": "number" },
        "debt": { "type": "number" },
        "loans": { "type": "number" }
      }
    },
    "Settings": {
      "type": "object",
      "description": "Application settings",
      "properties": {
        "lastUpdated": { "type": "integer" },
        "schema": { "type": "number" },
        "theme": { "type": "string" },
        "acceptedTerms": { "type": "boolean" },
        "storageChoice": { "type": "string" },
        "keepMeLoggedIn": { "type": "boolean" },
        "allowSupportAccess": { "type": "boolean" },
        "enablePlugins": { "type": "boolean" },
        "plugins": { "type": "object" },
        "completedOnboarding": { "type": "boolean" },
        "skipPlanWizard": { "type": "boolean" },
        "seenVersion": { "type": "string" },
        "autoProgress": { "type": "boolean" },
        "ci": { "type": "object", "properties": { "currency": { "type": "string" }, "locale": { "type": "string" } } },
        "plots": { "type": "object" },
        "tables": { "type": "object" },
        "progress": { "type": "object" },
        "today": { "type": "object" },
        "plan": { "type": "object" },
        "summary": { "type": "object" },
        "montecarlo": { "type": "object" }
      }
    }
  }
}
